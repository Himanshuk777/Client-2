<!DOCTYPE html>
<html lang="en">
<head>
    <!-- 
    ========================================================================================
    LEARNOVA - ELITE E-LEARNING PLATFORM
    ========================================================================================
    Version: 3.8 (DeepSeek AI, Dynamic Progress, Share Feature, Admin Controlled Help)
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="theme-color" content="#F9FAFB" id="metaThemeColor"> 
    
    <title>Learnova | Future Learning</title>
    
    <!-- DEPENDENCIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

        :root {
            /* BRAND COLORS */
            --brand-primary: #5D2EC0;
            --brand-accent: #7B4AE2;
            
            /* LIGHT MODE (DEFAULT) */
            --bg-body: #F9FAFB;
            --bg-card: #FFFFFF;
            --bg-glass: rgba(255, 255, 255, 0.95);
            --bg-input: #F3F4F6;
            --bg-hover: rgba(0, 0, 0, 0.05);
            --text-main: #111827;
            --text-muted: #6B7280;
            --border-color: rgba(0, 0, 0, 0.08);
            --shadow-card: 0 4px 20px rgba(0,0,0,0.05);
            --nav-bg: #5D2EC0;
            --nav-icon: rgba(255, 255, 255, 0.6);
            --nav-icon-active: #ffffff;
            
            --font-main: 'Outfit', sans-serif;
            --font-display: 'Space Grotesk', sans-serif;
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* DARK MODE OVERRIDES */
        body.dark-mode {
            --bg-body: #050505;
            --bg-card: #121212;
            --bg-glass: rgba(18, 18, 18, 0.9);
            --bg-input: #1A1A1A;
            --bg-hover: rgba(255, 255, 255, 0.05);
            --text-main: #ffffff;
            --text-muted: #a1a1aa;
            --border-color: rgba(255, 255, 255, 0.08);
            --shadow-card: 0 4px 20px rgba(0,0,0,0.2);
            --nav-bg: #101010;
            --nav-icon: #666;
            --nav-icon-active: #7B4AE2;
        }

        /* RESET & BASE */
        body {
            background-color: var(--bg-body);
            font-family: var(--font-main);
            color: var(--text-main);
            margin: 0; overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        /* UTILITIES */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .fade-in-up { animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .grid-animate { animation: popIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes popIn { 
            0% { opacity: 0; transform: scale(0.98) translateY(10px); } 
            100% { opacity: 1; transform: scale(1) translateY(0); } 
        }

        /* SURFACE CLASSES */
        .surface-card { background-color: var(--bg-card); border: 1px solid var(--border-color); box-shadow: var(--shadow-card); }
        .surface-input { background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-main); }
        .text-dynamic { color: var(--text-main); }
        .text-muted-dynamic { color: var(--text-muted); }

        /* HERO SLIDER */
        .hero-container {
            border-radius: 24px; overflow: hidden; position: relative;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
        }
        .hero-slide {
            position: absolute; inset: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0; transition: opacity 1s ease-in-out;
        }
        .hero-slide.active { opacity: 1; }
        
        /* LIQUID DOCK */
        .glass-dock {
            position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px; height: 72px;
            background: var(--nav-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            display: flex; justify-content: space-around; align-items: center;
            z-index: 1000;
            transition: background-color 0.4s ease;
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.3);
        }
        .dock-item { color: var(--nav-icon); display: flex; flex-direction: column; align-items: center; transition: color 0.3s ease; }
        .dock-item:active { transform: scale(0.9); }
        .dock-item.active { color: var(--nav-icon-active); }

        /* CHIPS */
        .cat-btn {
            padding: 10px 24px; border-radius: 100px; border: 1px solid var(--border-color);
            font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
            background: var(--bg-card); color: var(--text-muted); transition: var(--transition-smooth);
            white-space: nowrap; cursor: pointer; box-shadow: none !important;
        }
        .cat-btn.active { background: var(--brand-primary); color: white; border-color: var(--brand-primary); }

        /* HEADER */
        #mainHeader { transition: background 0.3s ease; background: var(--bg-body); border-bottom: 1px solid var(--border-color); }
        
        body.is-searching #brandLogo, body.is-searching #themeToggleBtn { display: none; }
        body.is-searching #mainContent, body.is-searching #navDock { filter: blur(12px); opacity: 0.4; pointer-events: none; }
        body.hide-search #searchContainer, body.hide-search #themeToggleBtn { display: none; }
        body.hide-search #brandLogo { flex: 1; } 
        #botHeaderTitle { display: none; }
        body.show-bot-header #brandLogo { display: none; }
        body.show-bot-header #botHeaderTitle { display: flex; }
        #headerProfile { display: none !important; } 

        #searchSuggestions {
            position: absolute; top: 100%; left: 0; width: 100%;
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 16px; margin-top: 12px; padding: 8px;
            z-index: 100; display: none; box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        /* INPUTS */
        .auth-input, .custom-select-trigger {
            width: 100%; background: var(--bg-input); border: 1px solid var(--border-color);
            padding: 18px; border-radius: 18px; color: var(--text-main); outline: none;
            font-family: var(--font-display); font-size: 14px; transition: all 0.3s ease;
        }
        .custom-select-trigger { cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .auth-input:focus, .custom-select-trigger:active { border-color: var(--brand-accent); background: var(--bg-card); }
        .auth-input::placeholder { color: var(--text-muted); opacity: 0.7; }

        /* MODALS */
        .center-modal {
            position: fixed; inset: 0; z-index: 6000;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .center-modal.active { opacity: 1; pointer-events: auto; }
        
        .country-list-container {
            width: 100%; max-width: 450px; background: var(--bg-card); 
            border-top-left-radius: 24px; border-top-right-radius: 24px;
            border: 1px solid var(--border-color); border-bottom: none;
            height: 70vh; display: flex; flex-direction: column; overflow: hidden;
        }
        .country-item { padding: 16px 24px; border-bottom: 1px solid var(--border-color); font-size: 14px; color: var(--text-muted); cursor: pointer; display: flex; justify-content: space-between; }
        .country-item:hover { background: var(--bg-hover); color: var(--text-main); }
        .country-item.selected { color: var(--brand-accent); font-weight: bold; }

        .page-section { min-height: 80vh; padding-bottom: 140px; transition: var(--transition-smooth); }

        /* CHAT */
        .chat-input-area { position: fixed; bottom: 110px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; z-index: 50; }
        .chat-bubble { max-width: 80%; padding: 14px 18px; border-radius: 18px; font-size: 13px; line-height: 1.5; margin-bottom: 12px; animation: fadeUp 0.3s ease-out; }
        .chat-user { background: var(--brand-primary); align-self: flex-end; color: white; border-bottom-right-radius: 4px; }
        .chat-bot { background: var(--bg-card); border: 1px solid var(--border-color); align-self: flex-start; color: var(--text-main); border-bottom-left-radius: 4px; }

        /* FAQ */
        .faq-section-title { font-size: 12px; font-weight: 800; color: var(--brand-accent); text-transform: uppercase; margin: 32px 0 12px 0; letter-spacing: 0.1em; border-bottom: 1px solid var(--border-color); padding-bottom: 8px; }
        .faq-item { border: 1px solid var(--border-color); border-radius: 16px; margin-bottom: 10px; background: var(--bg-card); overflow: hidden; transition: all 0.3s ease; }
        .faq-item:hover { border-color: var(--brand-accent); }
        .faq-item.open { border-color: var(--brand-accent); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .faq-header { padding: 18px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .faq-body { padding: 0 18px 18px 18px; display: none; color: var(--text-muted); font-size: 13px; line-height: 1.6; }
        .faq-item.open .faq-body { display: block; animation: fadeUp 0.3s ease; }
        .faq-arrow { transition: transform 0.3s ease; color: var(--text-muted); }
        .faq-item.open .faq-arrow { transform: rotate(180deg); color: var(--brand-accent); }

        /* LOADING */
        #loadingOverlay { background: rgba(5, 5, 5, 0.7); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }

        /* CHECKOUT CARD */
        .backpack-checkout-fixed {
            position: fixed; bottom: 110px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px;
            background: var(--bg-glass); 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--brand-accent);
            padding: 24px; border-radius: 32px; z-index: 500;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.4); 
            animation: slideUpCheck 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes slideUpCheck { from { transform: translate(-50%, 100px); opacity: 0; } to { transform: translate(-50%, 0); opacity: 1; } }
        #backpackList { padding-bottom: 280px; }

        /* COURSE CARD */
        .course-card {
            display: flex; gap: 16px; padding: 16px;
            background-color: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 24px; align-items: center; transition: transform 0.2s;
        }
        .course-card { border: 1px solid var(--brand-accent); }
        body.dark-mode .course-card { border: 1px solid var(--border-color); }
        .course-card:active { transform: scale(0.98); }
        .course-thumb { width: 90px; height: 90px; border-radius: 16px; object-fit: cover; box-shadow: 0 8px 16px rgba(0,0,0,0.3); }

        /* PROGRESS BAR */
        .progress-track { width: 100%; background: rgba(123, 74, 226, 0.1); height: 6px; border-radius: 10px; margin-top: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--brand-accent); border-radius: 10px; width: 0; transition: width 1s cubic-bezier(0.22, 1, 0.36, 1); }

    </style>
</head>
<body id="mainBody">

    <!-- LOADING SCREEN -->
    <div id="loadingOverlay" class="fixed inset-0 z-[9999] flex flex-col justify-center items-center transition-opacity duration-500">
        <lottie-player src="https://ik.imagekit.io/lssafvcmr/Client2/Triangle%20loading.json" background="transparent" speed="1" style="width: 150px; height: 150px;" loop autoplay></lottie-player>
    </div>

    <!-- AUTH PAGE -->
    <div id="authPage" class="fixed inset-0 z-[5000] bg-black flex flex-col justify-center p-6 hidden">
        <div class="mb-10 text-center">
            <h1 class="text-5xl font-black tracking-tighter font-[Space_Grotesk] mb-2">
                <span class="text-white">Learn</span><span class="text-[#7B4AE2]">ova</span>
            </h1>
            <p class="text-[10px] text-zinc-500 uppercase tracking-[0.5em] font-bold">Future Learning</p>
        </div>

        <div id="loginContainer" class="w-full max-w-md mx-auto bg-[#121212] border border-white/10 p-8 rounded-[32px]">
            <h2 class="text-2xl font-bold text-white mb-2 font-[Space_Grotesk]">Welcome Back</h2>
            <p class="text-xs text-zinc-500 mb-8">Access your enrolled courses.</p>
            <form id="loginForm" class="space-y-4">
                <input type="tel" id="loginMobile" placeholder="Mobile Number" class="auth-input" maxlength="10" required>
                <input type="password" id="loginPass" placeholder="Password" class="auth-input" required>
                <button type="submit" class="w-full bg-[#5D2EC0] text-white font-bold py-4 rounded-xl uppercase text-xs tracking-widest mt-4 hover:bg-[#421C90] transition-colors" style="box-shadow: none;">Login</button>
            </form>
            <p class="text-center text-xs text-zinc-600 mt-6 cursor-pointer hover:text-[#7B4AE2]" onclick="toggleAuth('signup')">Create Account</p>
        </div>

        <div id="signupContainer" class="hidden w-full max-w-md mx-auto bg-[#121212] border border-white/10 p-8 rounded-[32px] overflow-y-auto max-h-[90vh]">
            <h2 class="text-2xl font-bold text-white mb-2 font-[Space_Grotesk]">Join Learnova</h2>
            <form id="signupForm" class="space-y-4 mt-6">
                <input type="text" id="regName" placeholder="Full Name" class="auth-input" required>
                <input type="tel" id="regMobile" placeholder="Mobile Number" class="auth-input" maxlength="10" required>
                <div class="grid grid-cols-2 gap-4">
                    <div class="custom-select-trigger" onclick="openCountrySelector()">
                        <span id="regCountryDisplay" class="text-zinc-400">Country</span>
                        <i data-lucide="chevron-down" class="w-3 h-3 text-zinc-500"></i>
                    </div>
                    <input type="hidden" id="regCountry" required>
                    <input type="number" id="regAge" placeholder="Age" class="auth-input" required>
                </div>
                <input type="password" id="regPass" placeholder="Password" class="auth-input" required>
                <input type="password" id="regConfirmPass" placeholder="Confirm Password" class="auth-input" required>
                <button type="submit" class="w-full bg-[#7B4AE2] text-white font-bold py-4 rounded-xl uppercase text-xs tracking-widest mt-4" style="box-shadow: none;">Create Profile</button>
            </form>
            <p class="text-center text-xs text-zinc-600 mt-6 cursor-pointer hover:text-white" onclick="toggleAuth('login')">Back to Login</p>
        </div>
    </div>

    <!-- MAIN HEADER -->
    <header class="fixed top-0 w-full z-50 backdrop-blur-xl" id="mainHeader">
        <div class="max-w-2xl mx-auto px-6 h-16 flex items-center justify-between gap-4">
            <div id="brandLogo" class="text-xl font-black tracking-tight font-[Space_Grotesk] cursor-pointer whitespace-nowrap" onclick="showPage('courses')">
                <span class="text-dynamic">Learn</span><span class="text-[#7B4AE2]">ova</span>.
            </div>
            <div id="botHeaderTitle" class="items-center gap-3 hidden">
                <div class="w-8 h-8 rounded-full bg-[#5D2EC0] flex items-center justify-center"><i data-lucide="bot" class="w-5 h-5 text-white"></i></div>
                <div><h2 class="font-bold text-dynamic text-sm font-[Space_Grotesk]">BrainyBot</h2><p class="text-[9px] text-[#7B4AE2] uppercase font-bold">AI Assistant</p></div>
            </div>
            <div id="searchContainer" class="relative flex-1">
                <input type="text" id="searchInput" placeholder="Search..." autocomplete="off" class="w-full bg-transparent surface-input rounded-2xl px-5 py-2.5 text-xs font-medium focus:outline-none focus:border-[#7B4AE2]/50 transition-all placeholder:text-zinc-600">
                <i data-lucide="search" class="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500 pointer-events-none"></i>
                <div id="searchSuggestions"></div>
            </div>
            <button id="themeToggleBtn" onclick="toggleTheme()" class="w-8 h-8 rounded-full surface-card flex items-center justify-center text-dynamic hover:text-[#7B4AE2] transition-colors shadow-none"><i data-lucide="sun" class="w-4 h-4" id="themeIcon"></i></button>
        </div>
    </header>

    <!-- CONTENT -->
    <main class="pt-20 pb-32 min-h-screen max-w-2xl mx-auto px-5 relative" id="mainContent">
        
        <!-- 1. COURSES PAGE -->
        <div id="coursesPage" class="page-section fade-in-up">
            <h3 class="text-lg font-bold font-[Space_Grotesk] mb-4 text-dynamic">Course Recommendation</h3>
            <div class="hero-container aspect-video mb-8">
                <div id="heroSlider" class="w-full h-full relative"></div> 
            </div>

            <h3 class="text-lg font-bold font-[Space_Grotesk] mb-4 text-dynamic">Categories</h3>
            <div class="flex gap-3 overflow-x-auto no-scrollbar mb-8 pb-2">
                <button onclick="filterCourses('All', this)" class="cat-btn active">All</button>
                <button onclick="filterCourses('AI', this)" class="cat-btn">AI</button>
                <button onclick="filterCourses('Technology', this)" class="cat-btn">Technology</button>
                <button onclick="filterCourses('Business', this)" class="cat-btn">Business</button>
                <button onclick="filterCourses('Finance', this)" class="cat-btn">Finance</button>
                <button onclick="filterCourses('Marketing', this)" class="cat-btn">Marketing</button>
                <button onclick="filterCourses('Creative', this)" class="cat-btn">Creative</button>
            </div>

            <div class="grid grid-cols-1 gap-5" id="coursesGrid"></div>
        </div>

        <!-- 1.5. SEARCH RESULTS -->
        <div id="searchPage" class="hidden page-section fade-in-up">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold font-[Space_Grotesk] text-dynamic">Results for "<span id="queryText" class="text-[#7B4AE2]"></span>"</h2>
                <button onclick="showPage('courses')" class="text-xs text-zinc-500 font-bold uppercase">Clear</button>
            </div>
            <div id="searchResultsGrid" class="grid grid-cols-1 gap-4"></div>
        </div>

        <!-- 2. BRAINYBOT PAGE -->
        <div id="chatbotPage" class="hidden page-section h-screen flex flex-col relative pb-40">
            <div id="chatHistory" class="flex-1 overflow-y-auto no-scrollbar flex flex-col gap-2 p-2 mb-4">
                <div class="chat-bubble chat-bot">Hello! I'm BrainyBot. How can I help you today?</div>
            </div>
            <div class="chat-input-area flex gap-2">
                <input type="text" id="chatInput" placeholder="Ask BrainyBot..." class="flex-1 surface-input rounded-xl px-4 py-3 text-sm focus:border-[#7B4AE2] outline-none shadow-xl">
                <button onclick="sendChat()" class="w-12 h-12 bg-[#7B4AE2] rounded-xl flex items-center justify-center text-white hover:scale-95 transition-transform shadow-none">
                    <i data-lucide="send" class="w-5 h-5 ml-0.5 mt-0.5"></i>
                </button>
            </div>
        </div>

        <!-- 3. BACKPACK PAGE -->
        <div id="backpackPage" class="hidden page-section fade-in-up">
            <h2 class="text-3xl font-black font-[Space_Grotesk] mb-2 text-dynamic">My Backpack</h2>
            <p class="text-xs text-muted-dynamic mb-8 uppercase tracking-widest">Ready to enroll?</p>
            <div id="backpackList" class="space-y-4"></div>
            <!-- CHECKOUT CARD -->
            <div class="backpack-checkout-fixed" id="backpackCheckoutCard">
                <div class="flex w-full gap-2 mb-5 p-1 rounded-2xl border border-white/5 bg-black/5 items-center">
                    <input type="text" id="couponInput" placeholder="Promo Code" class="flex-1 min-w-0 bg-transparent border-none outline-none px-3 text-xs font-bold text-dynamic placeholder:text-muted-dynamic h-10">
                    <button onclick="applyCoupon()" class="shrink-0 bg-[#5D2EC0] text-white px-5 h-10 rounded-xl text-[10px] font-bold uppercase hover:bg-[#421C90] transition-colors shadow-none">Apply</button>
                </div>
                <div id="couponMessage" class="text-[10px] text-center mb-3 font-bold hidden"></div>
                <div class="flex justify-between mb-2 text-xs text-muted-dynamic px-2"><span>Subtotal</span><span id="bpSubtotal">₹0</span></div>
                <div class="flex justify-between mb-6 text-2xl font-black text-dynamic px-2"><span>Total</span><span class="text-[#7B4AE2]" id="bpTotal">₹0</span></div>
                <button onclick="initiatePayment()" class="w-full bg-[#5D2EC0] text-white font-bold py-4 rounded-2xl uppercase text-xs tracking-[0.2em] transition-all transform hover:scale-[1.02] shadow-none">Secure Checkout</button>
            </div>
        </div>

        <!-- 4. PROFILE PAGE -->
        <div id="profilePage" class="hidden page-section fade-in-up">
            <div class="flex flex-col items-center mb-10">
                <div class="w-24 h-24 rounded-full p-1 bg-gradient-to-br from-[#7B4AE2] to-[#5D2EC0] mb-4">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Student" class="w-full h-full rounded-full bg-[#111]" id="profilePageImg">
                </div>
                <h2 id="profileName" class="text-2xl font-bold font-[Space_Grotesk] text-dynamic">Guest Learner</h2>
                <div class="flex items-center gap-2 mt-1 mb-2">
                    <span id="profileMobile" class="text-muted-dynamic text-xs font-mono">--</span>
                </div>
                <span class="px-4 py-1.5 rounded-full bg-[#5D2EC0]/10 text-[#7B4AE2] text-[10px] font-bold uppercase tracking-widest border border-[#5D2EC0]/20">Inspire the World</span>
            </div>
            <div class="space-y-3">
                <button onclick="showPage('myCourses')" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="book-open" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">My Courses</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="openNameModal()" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="edit-3" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Change Name</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="showPage('certificates')" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="award" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Certificate of Achievements</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="showPage('paymentMethods')" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="credit-card" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Payment Methods</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="openWhatsAppHelp()" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="help-circle" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Help Centre</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="showPage('faqs')" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="message-circle-question" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">FAQs</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="showPage('security')" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="shield-check" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Security & Privacy</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <!-- SHARE BUTTON -->
                <button onclick="shareApp()" class="w-full p-5 surface-card rounded-2xl flex items-center justify-between hover:border-[#7B4AE2]/50 transition-colors group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-[#5D2EC0]/10 flex items-center justify-center text-[#5D2EC0]"><i data-lucide="share-2" class="w-5 h-5"></i></div><span class="font-bold text-sm text-dynamic">Share App</span></div><i data-lucide="chevron-right" class="w-4 h-4 text-muted-dynamic group-hover:text-[#7B4AE2]"></i></button>
                <button onclick="openModal('logoutModal')" class="w-full p-5 bg-red-500/5 border border-red-500/10 rounded-2xl flex items-center justify-between hover:bg-red-500/10 transition-colors mt-6 shadow-none"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-red-500/10 flex items-center justify-center text-red-500"><i data-lucide="log-out" class="w-5 h-5"></i></div><span class="font-bold text-sm text-red-500">Log Out</span></div></button>
            </div>
        </div>

        <!-- 5. MY COURSES SCREEN -->
        <div id="myCoursesPage" class="hidden page-section fade-in-up">
            <div class="flex items-center gap-4 mb-6"><button onclick="showPage('profile')" class="w-10 h-10 rounded-full surface-card flex items-center justify-center hover:bg-white/10 shadow-none"><i data-lucide="arrow-left" class="w-5 h-5 text-dynamic"></i></button><h2 class="text-2xl font-black font-[Space_Grotesk] text-dynamic">My Courses</h2></div>
            <div id="enrolledList" class="space-y-4"></div>
        </div>

        <!-- 6. CERTIFICATES SCREEN -->
        <div id="certificatesPage" class="hidden page-section fade-in-up">
            <div class="flex items-center gap-4 mb-6"><button onclick="showPage('profile')" class="w-10 h-10 rounded-full surface-card flex items-center justify-center hover:bg-white/10 shadow-none"><i data-lucide="arrow-left" class="w-5 h-5 text-dynamic"></i></button><h2 class="text-2xl font-black font-[Space_Grotesk] text-dynamic">Certificates</h2></div>
            <div id="certificatesList" class="space-y-4"></div>
        </div>

        <!-- NEW: PAYMENT METHODS SCREEN -->
        <div id="paymentMethodsPage" class="hidden page-section fade-in-up">
            <div class="flex items-center gap-4 mb-6"><button onclick="showPage('profile')" class="w-10 h-10 rounded-full surface-card flex items-center justify-center hover:bg-white/10 shadow-none"><i data-lucide="arrow-left" class="w-5 h-5 text-dynamic"></i></button><h2 class="text-2xl font-black font-[Space_Grotesk] text-dynamic">Payment Methods</h2></div>
            <div class="surface-card p-6 rounded-2xl">
                <p class="text-sm font-bold text-dynamic mb-4">Available options</p>
                <div class="space-y-3">
                    <div class="flex items-center gap-3 p-3 surface-input rounded-xl"><i data-lucide="smartphone" class="w-5 h-5 text-[#7B4AE2]"></i><span class="text-dynamic text-sm font-bold">1. UPI</span></div>
                    <div class="flex items-center gap-3 p-3 surface-input rounded-xl"><i data-lucide="credit-card" class="w-5 h-5 text-[#7B4AE2]"></i><span class="text-dynamic text-sm font-bold">2. Credit/Debit Cards</span></div>
                    <div class="flex items-center gap-3 p-3 surface-input rounded-xl"><i data-lucide="globe" class="w-5 h-5 text-[#7B4AE2]"></i><span class="text-dynamic text-sm font-bold">3. PayPal</span></div>
                    <div class="flex items-center gap-3 p-3 surface-input rounded-xl"><i data-lucide="clock" class="w-5 h-5 text-[#7B4AE2]"></i><span class="text-dynamic text-sm font-bold">4. Buy Now, Pay Later (BNPL)</span></div>
                </div>
            </div>
        </div>

        <!-- 7. FAQs SCREEN (RESTORED & EXPANDED) -->
        <div id="faqsPage" class="hidden page-section fade-in-up">
            <div class="flex items-center gap-4 mb-6"><button onclick="showPage('profile')" class="w-10 h-10 rounded-full surface-card flex items-center justify-center hover:bg-white/10 shadow-none"><i data-lucide="arrow-left" class="w-5 h-5 text-dynamic"></i></button><h2 class="text-2xl font-black font-[Space_Grotesk] text-dynamic">FAQs</h2></div>
            <div class="space-y-2">
                <h4 class="faq-section-title">Getting Started</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">What is Learnova?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Learnova is an elite e-learning platform focusing on futuristic skills like AI, Blockchain, and Digital Business.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">How do I create an account?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Simply download the app or visit the site, click "Create Account," enter your mobile number, and fill in your details.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Is it free to join?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, creating a profile is free. You only pay for the courses you wish to enroll in.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Can I use Learnova on Mobile?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Absolutely. Our platform is fully responsive and optimized for all mobile devices.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Can I share my account?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Account sharing is against our policy. Our system detects multiple simultaneous logins.</div></div>

                <h4 class="faq-section-title">Courses & Content</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">How do I access courses?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Once purchased, courses appear in "My Courses" section forever.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Are the courses pre-recorded?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Most courses are self-paced video lectures, allowing you to learn at your own convenience.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Do courses expire?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">No, you have lifetime access to any course you purchase.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Are materials downloadable?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, premium courses often include downloadable PDFs, source code, and project files.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">What languages are available?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Currently, all courses are in English. Subtitles for other languages are coming soon.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">How often is content updated?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">We update tech courses monthly to ensure they match current industry standards.</div></div>

                <h4 class="faq-section-title">Payments & Refunds</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">What payment methods do you accept?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">UPI, Credit/Debit Cards, Net Banking, and select Wallets.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Refund Policy?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">7-day money back guarantee if progress is under 10%.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Is my payment secure?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, we use AES-256 encryption and do not store card details.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Do you offer installments?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">We support Buy Now Pay Later options via our payment partners for courses over ₹5000.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">How do I use a coupon?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Enter the code in the "My Backpack" checkout screen before paying.</div></div>

                <h4 class="faq-section-title">Certification</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Do I get a certificate?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, a verifiable digital certificate is issued upon 100% completion.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Is the certificate valid for jobs?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Our certificates are recognized by partner startups and great for your LinkedIn profile.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Where can I find my certificate?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Go to Profile > Certificate of Achievements to view and download them.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Can I change the name on it?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Update your profile name before completing the course to ensure accuracy.</div></div>

                <h4 class="faq-section-title">Technical Support</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Video playback issues?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Check your internet. Try lowering resolution or clearing browser cache.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">App is crashing?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Ensure you are on the latest version. Reinstalling usually fixes this.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">I forgot my password.</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Contact support via WhatsApp to verify identity and reset credentials.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Minimum System Requirements?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Any modern smartphone (Android/iOS) or a web browser (Chrome/Safari).</div></div>

                <h4 class="faq-section-title">BrainyBot AI</h4>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">What is BrainyBot?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">It is our integrated AI assistant powered by advanced LLMs to answer your queries.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Is BrainyBot free?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, it is free for all registered users to assist with learning.</div></div>
                <div class="faq-item"><div class="faq-header" onclick="toggleFaq(this)"><span class="text-dynamic">Can it write code for me?</span><i data-lucide="chevron-down" class="w-4 h-4 faq-arrow"></i></div><div class="faq-body">Yes, BrainyBot can generate code snippets, explain concepts, and debug errors.</div></div>
            </div>
        </div>

        <!-- 8. SECURITY SCREEN -->
        <div id="securityPage" class="hidden page-section fade-in-up">
            <div class="flex items-center gap-4 mb-6"><button onclick="showPage('profile')" class="w-10 h-10 rounded-full surface-card flex items-center justify-center hover:bg-white/10 shadow-none"><i data-lucide="arrow-left" class="w-5 h-5 text-dynamic"></i></button><h2 class="text-2xl font-black font-[Space_Grotesk] text-dynamic">Security</h2></div>
            <div class="surface-card p-6 rounded-2xl mb-6">
                <div class="flex items-center justify-between mb-4"><span class="text-sm font-bold text-dynamic">Data Encryption</span><span class="text-xs text-[#7B4AE2] font-mono">AES-256</span></div>
                <div class="flex items-center justify-between mb-4"><span class="text-sm font-bold text-dynamic">Account Status</span><span class="text-xs text-green-500">Verified</span></div>
                <p class="text-[10px] text-muted-dynamic mt-4 leading-relaxed">Your data is secured using industry standard encryption.</p>
            </div>
        </div>

    </main>

    <!-- NAVIGATION DOCK -->
    <nav class="glass-dock" id="navDock">
        <button onclick="showPage('courses')" class="dock-item active" data-page="courses"><i data-lucide="layout-grid" class="w-6 h-6"></i></button>
        <button onclick="showPage('chatbot')" class="dock-item" data-page="chatbot"><i data-lucide="bot" class="w-6 h-6"></i></button>
        <button onclick="showPage('backpack')" class="dock-item relative" data-page="backpack"><i data-lucide="backpack" class="w-6 h-6"></i><span id="bpBadge" class="absolute -top-1 -right-1 bg-[#5D2EC0] text-white text-[9px] font-bold w-4 h-4 rounded-full flex items-center justify-center hidden">0</span></button>
        <button onclick="showPage('profile')" class="dock-item" data-page="profile"><i data-lucide="user" class="w-6 h-6"></i></button>
    </nav>

    <!-- ========= MODALS ========= -->
    <div id="paymentModal" class="center-modal">
        <div class="surface-card p-6 rounded-3xl w-[90%] max-w-sm shadow-2xl text-center">
            <div class="w-16 h-16 bg-[#5D2EC0]/10 rounded-full flex items-center justify-center mx-auto mb-4 text-[#5D2EC0]"><i data-lucide="credit-card" class="w-8 h-8"></i></div>
            <h3 class="text-lg font-bold text-dynamic mb-2">Confirm Payment</h3>
            <p class="text-muted-dynamic text-xs mb-6">Proceed with the transaction?</p>
            <div class="flex gap-3"><button onclick="processPayment(false)" class="flex-1 py-3 rounded-xl bg-white/5 text-muted-dynamic font-bold text-xs uppercase hover:bg-white/10 shadow-none">No, Cancel</button><button onclick="processPayment(true)" class="flex-1 py-3 rounded-xl bg-[#5D2EC0] text-white font-bold text-xs uppercase hover:bg-[#421C90] shadow-none">Yes, Pay</button></div>
        </div>
    </div>

    <div id="nameModal" class="center-modal">
        <div class="surface-card p-6 rounded-3xl w-[90%] max-w-sm shadow-2xl">
            <h3 class="text-lg font-bold text-dynamic mb-4">Update Identity</h3>
            <input type="text" id="newNameInput" class="auth-input mb-4" placeholder="Enter new name">
            <div class="flex gap-3"><button onclick="closeModal('nameModal')" class="flex-1 py-3 rounded-xl bg-white/5 text-muted-dynamic font-bold text-xs uppercase shadow-none">Cancel</button><button onclick="saveNewName()" class="flex-1 py-3 rounded-xl bg-[#5D2EC0] text-white font-bold text-xs uppercase shadow-none">Save</button></div>
        </div>
    </div>

    <div id="countryModal" class="center-modal" style="align-items: flex-end;">
        <div class="country-list-container">
            <div class="p-4 border-b border-white/10 flex justify-between items-center bg-[#151515]"><h3 class="font-bold text-white">Select Country</h3><button onclick="closeModal('countryModal')" class="text-zinc-500 shadow-none"><i data-lucide="x" class="w-5 h-5"></i></button></div>
            <div class="flex-1 overflow-y-auto bg-[#121212]" id="countryListContainer"></div>
        </div>
    </div>

    <div id="logoutModal" class="center-modal">
        <div class="surface-card p-6 rounded-3xl w-[90%] max-w-sm text-center shadow-2xl">
            <div class="w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-red-500"><i data-lucide="log-out" class="w-6 h-6"></i></div>
            <h3 class="text-lg font-bold text-dynamic mb-2">Confirm Logout</h3>
            <p class="text-muted-dynamic text-xs mb-6">Are you sure you want to exit?</p>
            <div class="flex gap-3"><button onclick="closeModal('logoutModal')" class="flex-1 py-3 rounded-xl bg-white/5 text-muted-dynamic font-bold text-xs uppercase shadow-none">Cancel</button><button onclick="performLogout()" class="flex-1 py-3 rounded-xl bg-red-500 text-white font-bold text-xs uppercase hover:bg-red-600 shadow-none">Yes, Logout</button></div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get, set, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCVpMjQVY3rDcali-1m6ijYSLbm80JifCE",
            authDomain: "client-ef148.firebaseapp.com",
            databaseURL: "https://client-ef148-default-rtdb.firebaseio.com",
            projectId: "client-ef148",
            storageBucket: "client-ef148.firebasestorage.app",
            messagingSenderId: "352061768776",
            appId: "1:352061768776:web:f35b561f964ea00c81847d",
            measurementId: "G-KT049VJBVW"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let currentUser = null;
        let backpack = JSON.parse(localStorage.getItem('learnova_backpack')) || [];
        let activeCategory = 'All';
        let currentDiscount = 0;
        
        // THEME LOGIC
        window.toggleTheme = function() {
            const body = document.body;
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');
            localStorage.setItem('learnova_theme', isDark ? 'dark' : 'light');
            
            const icon = document.getElementById('themeIcon');
            if(isDark) icon.setAttribute('data-lucide', 'sun');
            else icon.setAttribute('data-lucide', 'moon');
            
            const metaTheme = document.getElementById('metaThemeColor');
            if(isDark) metaTheme.content = "#050505";
            else metaTheme.content = "#F9FAFB";
            
            lucide.createIcons();
        }

        const savedTheme = localStorage.getItem('learnova_theme');
        if(savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            document.getElementById('metaThemeColor').content = "#050505";
            setTimeout(() => {
                 const icon = document.getElementById('themeIcon');
                 if(icon) { icon.setAttribute('data-lucide', 'sun'); lucide.createIcons(); }
            }, 100);
        }

        const top50Countries = [ "India", "United States", "China", "Indonesia", "Pakistan", "Nigeria", "Brazil", "Bangladesh", "Russia", "Mexico", "Japan", "Ethiopia", "Philippines", "Egypt", "Vietnam", "DR Congo", "Turkey", "Iran", "Germany", "Thailand", "United Kingdom", "France", "Italy", "Tanzania", "South Africa", "Myanmar", "Kenya", "South Korea", "Colombia", "Spain", "Uganda", "Argentina", "Algeria", "Sudan", "Ukraine", "Iraq", "Afghanistan", "Poland", "Canada", "Morocco", "Saudi Arabia", "Uzbekistan", "Peru", "Angola", "Malaysia", "Mozambique", "Ghana", "Yemen", "Nepal", "Venezuela" ].sort();

        const courses = [
            { id: 'course001', cat: 'AI', title: 'Prompt Engineering', price: 4999, link: 'course001.html', desc: 'Master AI prompting.', img: '' },
            { id: 'course002', cat: 'AI', title: 'AI Agent Development', price: 6999, link: 'course002.html', desc: 'No-code agents.', img: '' },
            { id: 'course003', cat: 'AI', title: 'AI Marketing', price: 3499, link: 'course003.html', desc: 'Automate reach.', img: '' },
            { id: 'course004', cat: 'AI', title: 'UI/UX for AI', price: 5499, link: 'course004.html', desc: 'Future interfaces.', img: '' },
            { id: 'course005', cat: 'Technology', title: 'Full-Stack Web', price: 8999, link: 'course005.html', desc: 'MERN Stack.', img: '' },
            { id: 'course006', cat: 'Technology', title: 'Mobile App Dev', price: 7999, link: 'course006.html', desc: 'Flutter/React.', img: '' },
            { id: 'course007', cat: 'Technology', title: 'Cloud Architect', price: 9999, link: 'course007.html', desc: 'AWS/Azure.', img: '' },
            { id: 'course008', cat: 'Technology', title: 'Cybersecurity', price: 6499, link: 'course008.html', desc: 'Ethical Hacking.', img: '' },
            { id: 'course009', cat: 'Technology', title: 'Data Analytics', price: 5999, link: 'course009.html', desc: 'Visualize Data.', img: '' },
            { id: 'course010', cat: 'Technology', title: 'Blockchain', price: 8499, link: 'course010.html', desc: 'Web3 Contracts.', img: '' },
            { id: 'course011', cat: 'Business', title: 'SaaS Sales', price: 4499, link: 'course011.html', desc: 'Global sales.', img: '' },
            { id: 'course012', cat: 'Business', title: 'High-Ticket Sales', price: 5999, link: 'course012.html', desc: 'Close big deals.', img: '' },
            { id: 'course013', cat: 'Business', title: 'E-commerce', price: 4999, link: 'course013.html', desc: 'Brand management.', img: '' },
            { id: 'course014', cat: 'Business', title: 'Startup 101', price: 5999, link: 'course014.html', desc: 'Launch fast.', img: '' },
            { id: 'course015', cat: 'Business', title: 'Affiliate Marketing', price: 2999, link: 'course015.html', desc: 'Passive income.', img: '' },
            { id: 'course016', cat: 'Finance', title: 'Algo Trading', price: 10999, link: 'course016.html', desc: 'Automate profits.', img: '' },
            { id: 'course017', cat: 'Finance', title: 'DeFi Mastery', price: 7499, link: 'course017.html', desc: 'Crypto finance.', img: '' },
            { id: 'course018', cat: 'Marketing', title: 'Social Growth', price: 3999, link: 'course018.html', desc: 'Viral tactics.', img: '' },
            { id: 'course019', cat: 'Marketing', title: 'Digital Ads', price: 4599, link: 'course019.html', desc: 'SEO & PPC.', img: '' },
            { id: 'course020', cat: 'Creative', title: '3D Motion', price: 6999, link: 'course020.html', desc: 'Blender & C4D.', img: '' },
            { id: 'course021', cat: 'Creative', title: 'Video Editing', price: 2999, link: 'course021.html', desc: 'Reels & TikTok.', img: '' },
            { id: 'course022', cat: 'Creative', title: 'Podcasting', price: 3499, link: 'course022.html', desc: 'Audio production.', img: '' }
        ];

        window.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            fetchAdminData();
            updateBackpackUI();
            checkSession();
            initSearch();
            initCountryList();
        });

        function fetchAdminData() {
            const adminRef = ref(db, 'admin');
            get(adminRef).then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    const bannerImages = data.recommendBanners || {};
                    const courseImages = data.courseBanners || {};
                    courses.forEach(c => {
                        if (courseImages[c.id]) c.img = courseImages[c.id];
                        else c.img = `https://via.placeholder.com/400x400/121212/5D2EC0?text=${c.title.replace(' ','+')}`;
                    });
                    renderCourses();
                    initHero(bannerImages);
                } else {
                    renderCourses();
                }
            });
        }

        function initHero(banners = {}) {
            const container = document.getElementById('heroSlider');
            const bannerKeys = Object.keys(banners);
            if (bannerKeys.length === 0) return;
            const selectedKeys = bannerKeys.sort(() => 0.5 - Math.random()).slice(0, 5);
            container.innerHTML = selectedKeys.map((key, i) => {
                const randomCourseNum = String(Math.floor(Math.random() * 22) + 1).padStart(3, '0');
                const redirectLink = `course${randomCourseNum}.html`;
                return `<img src="${banners[key]}" class="hero-slide ${i===0?'active':''}" data-link="${redirectLink}" onclick="window.location.href='${redirectLink}'">`;
            }).join('');
            
            let idx = 0;
            const slides = container.querySelectorAll('.hero-slide');
            setInterval(() => {
                slides[idx].classList.remove('active');
                idx = (idx + 1) % selectedKeys.length;
                slides[idx].classList.add('active');
            }, 3000); 
        }

        window.showPage = function(pageId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
            document.getElementById(pageId + 'Page').classList.remove('hidden');
            const body = document.body;
            if(pageId === 'courses') {
                body.classList.remove('hide-search');
                body.classList.remove('show-bot-header');
            } else if (pageId === 'chatbot') {
                body.classList.add('hide-search');
                body.classList.add('show-bot-header');
            } else {
                body.classList.add('hide-search');
                body.classList.remove('show-bot-header');
            }
            body.classList.remove('is-searching');
            document.getElementById('searchSuggestions').style.display = 'none';
            document.getElementById('searchInput').value = '';
            document.querySelectorAll('.dock-item').forEach(el => el.classList.remove('active'));
            let activeDock = pageId;
            if(['myCourses', 'certificates', 'faqs', 'security', 'paymentMethods'].includes(pageId)) activeDock = 'profile';
            const dock = document.querySelector(`.dock-item[data-page="${activeDock}"]`);
            if(dock) dock.classList.add('active');
            if(pageId === 'myCourses') renderEnrolled();
            if(pageId === 'certificates') renderCertificates();
            window.scrollTo(0,0);
        };

        window.filterCourses = function(cat, btn) {
            activeCategory = cat;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderCourses(true);
        };

        function renderCourses(animate = false) {
            const filtered = activeCategory === 'All' ? courses : courses.filter(c => c.cat === activeCategory);
            const grid = document.getElementById('coursesGrid');
            
            if(animate) {
                grid.classList.remove('grid-animate');
                void grid.offsetWidth;
                grid.classList.add('grid-animate');
            }

            if(filtered.length === 0) return grid.innerHTML = `<div class="text-center text-zinc-600 py-10">No courses available.</div>`;
            
            grid.innerHTML = filtered.map(c => {
                const isEnrolled = currentUser && currentUser.enrolledCourses && currentUser.enrolledCourses[c.id];
                let actionBtn;
                if(isEnrolled) {
                    actionBtn = `<button onclick="event.stopPropagation(); openCourse('${c.link}')" class="bg-[#5D2EC0]/10 text-[#5D2EC0] p-2 rounded-xl transition-colors border border-[#5D2EC0]/20 shadow-none"><i data-lucide="eye" class="w-4 h-4"></i></button>`;
                } else {
                    actionBtn = `<button onclick="event.stopPropagation(); addToBackpack('${c.id}')" class="bg-white/5 hover:bg-[#7B4AE2] hover:text-white text-dynamic p-2 rounded-xl transition-colors border border-white/5 shadow-none"><i data-lucide="plus" class="w-4 h-4"></i></button>`;
                }

                return `
                <div class="course-card group cursor-pointer" onclick="openCourse('${c.link}')">
                    <img src="${c.img}" class="course-thumb grayscale group-hover:grayscale-0 transition-all">
                    <div class="flex flex-col flex-1 h-full justify-between py-1">
                        <div>
                            <div class="flex justify-between items-start">
                                <span class="text-[9px] text-[#7B4AE2] font-extrabold uppercase tracking-widest bg-[#7B4AE2]/10 px-2 py-0.5 rounded-full mb-1 inline-block border border-[#7B4AE2]/20">${c.cat}</span>
                            </div>
                            <h4 class="text-dynamic font-bold text-sm leading-snug group-hover:text-[#7B4AE2] transition-colors">${c.title}</h4>
                            <p class="text-[10px] text-muted-dynamic line-clamp-1 mt-1">${c.desc}</p>
                        </div>
                        <div class="flex justify-between items-end mt-2">
                            <span class="text-dynamic font-bold text-sm">₹${c.price}</span>
                            ${actionBtn}
                        </div>
                    </div>
                </div>`;
            }).join('');
            lucide.createIcons();
        }
        window.openCourse = function(link) { window.location.href = link; };

        // BACKPACK
        window.addToBackpack = function(id) {
            if(backpack.some(i => i.id === id)) return alert("Already added!");
            backpack.push(courses.find(c => c.id === id));
            localStorage.setItem('learnova_backpack', JSON.stringify(backpack));
            updateBackpackUI();
        };
        window.removeFromBackpack = function(id) {
            backpack = backpack.filter(i => i.id !== id);
            localStorage.setItem('learnova_backpack', JSON.stringify(backpack));
            currentDiscount = 0; 
            document.getElementById('couponMessage').classList.add('hidden');
            document.getElementById('couponInput').value = '';
            updateBackpackUI();
        };

        window.applyCoupon = function() {
            const code = document.getElementById('couponInput').value.trim();
            const msg = document.getElementById('couponMessage');
            if(!code) return;
            
            get(ref(db, 'admin/couponCode/' + code)).then(snap => {
                if(snap.exists()) {
                    const val = snap.val().toString();
                    let discountAmount = 0;
                    const subtotal = backpack.reduce((sum, item) => sum + item.price, 0);

                    if(val.includes('%')) {
                        const percent = parseFloat(val.replace('%', ''));
                        discountAmount = (subtotal * percent) / 100;
                    } else {
                        discountAmount = Math.abs(parseFloat(val));
                    }
                    
                    currentDiscount = discountAmount;
                    msg.innerText = `Coupon Applied! Saved ₹${discountAmount.toFixed(0)}`;
                    msg.classList.remove('hidden', 'text-red-500');
                    msg.classList.add('text-green-500');
                    updateBackpackUI(); 
                } else {
                    currentDiscount = 0;
                    msg.innerText = "Invalid Coupon Code";
                    msg.classList.remove('hidden', 'text-green-500');
                    msg.classList.add('text-red-500');
                    updateBackpackUI();
                }
            });
        }

        function updateBackpackUI() {
            const list = document.getElementById('backpackList');
            const checkoutCard = document.getElementById('backpackCheckoutCard');
            const badge = document.getElementById('bpBadge');
            badge.innerText = backpack.length;
            badge.classList.toggle('hidden', backpack.length === 0);
            
            if(backpack.length === 0) {
                list.innerHTML = `<div class="text-center py-20 text-muted-dynamic text-xs uppercase tracking-widest border border-dashed border-white/10 rounded-2xl">Empty</div>`;
                checkoutCard.style.display = 'none';
                return;
            }
            checkoutCard.style.display = 'block';
            
            let subtotal = 0;
            list.innerHTML = backpack.map(c => {
                subtotal += c.price;
                return `<div class="flex gap-4 p-4 surface-card rounded-2xl items-center"><img src="${c.img}" class="w-16 h-16 rounded-xl grayscale object-cover"><div class="flex-1"><h4 class="text-dynamic font-bold text-sm">${c.title}</h4><p class="text-[#7B4AE2] text-xs font-bold mt-1">₹${c.price}</p></div><button onclick="removeFromBackpack('${c.id}')" class="shadow-none"><i data-lucide="trash-2" class="w-4 h-4 text-muted-dynamic"></i></button></div>`
            }).join('');
            
            const finalTotal = Math.max(0, subtotal - currentDiscount);
            document.getElementById('bpSubtotal').innerText = `₹${subtotal}`;
            document.getElementById('bpTotal').innerText = `₹${finalTotal}`;
            lucide.createIcons();
        }

        window.initiatePayment = function() {
            if(!currentUser) return alert("Login required");
            if(backpack.length === 0) return;
            openModal('paymentModal');
        }

        window.processPayment = function(confirmed) {
            closeModal('paymentModal');
            if(confirmed) {
                const userUpdates = {};
                const adminUpdates = {};

                backpack.forEach(c => {
                    userUpdates[`users/${currentUser.mobileNumber}/enrolledCourses/${c.id}`] = true;
                    adminUpdates[`admin/userCourseEnrollment/${currentUser.mobileNumber}/${c.id}`] = {
                        PaymentStatus: "Paid",
                        Progress: 0,
                        Certificate: ""
                    };
                });
                
                Promise.all([
                    update(ref(db), userUpdates),
                    update(ref(db), adminUpdates)
                ]).then(() => {
                    alert("Payment Successful! Course Enrolled.");
                    backpack = [];
                    currentDiscount = 0;
                    localStorage.setItem('learnova_backpack', JSON.stringify([]));
                    updateBackpackUI();
                    
                    get(ref(db, 'users/'+currentUser.mobileNumber)).then(s => {
                         if(s.exists()) {
                             currentUser = s.val();
                             renderCourses(); 
                         }
                         showPage('myCourses');
                    });
                }).catch(e => alert("Error enrolling: " + e.message));
            }
        }

        // DYNAMIC ENROLLED LIST WITH PROGRESS
        async function renderEnrolled() {
            const list = document.getElementById('enrolledList');
            if(!currentUser || !currentUser.enrolledCourses) return list.innerHTML = '<div class="text-muted-dynamic text-center py-10">No courses yet.</div>';
            
            const enrolledIds = Object.keys(currentUser.enrolledCourses);
            const myC = courses.filter(c => enrolledIds.includes(c.id));
            
            // Fetch progress data asynchronously
            const adminSnap = await get(ref(db, `admin/userCourseEnrollment/${currentUser.mobileNumber}`));
            const adminData = adminSnap.exists() ? adminSnap.val() : {};

            list.innerHTML = myC.map(c => {
                const prog = (adminData[c.id] && adminData[c.id].Progress) ? adminData[c.id].Progress : 0;
                return `
                <div class="flex gap-4 p-4 surface-card rounded-2xl items-center cursor-pointer" onclick="openCourse('${c.link}')">
                    <img src="${c.img}" class="w-16 h-16 rounded-xl object-cover grayscale">
                    <div class="flex-1">
                        <div class="flex justify-between items-center mb-1">
                            <h4 class="text-dynamic font-bold text-sm">${c.title}</h4>
                            <span class="text-[10px] text-[#7B4AE2] font-bold">${prog}%</span>
                        </div>
                        <div class="progress-track">
                            <div class="progress-fill" style="width: 0%" data-width="${prog}%"></div>
                        </div>
                    </div>
                </div>`;
            }).join('');
            
            requestAnimationFrame(() => {
                document.querySelectorAll('.progress-fill').forEach(el => {
                    setTimeout(() => el.style.width = el.getAttribute('data-width'), 50);
                });
            });
        }

        // WHATSAPP HELP DYNAMIC
        window.openWhatsAppHelp = async function() {
            const snap = await get(ref(db, 'admin/whatsappNumber'));
            const num = snap.exists() ? snap.val() : '917000742966';
            const msg = encodeURIComponent("I need help with Learnova.");
            window.open(`https://wa.me/${num}?text=${msg}`, '_blank');
        };

        // SHARE APP DYNAMIC
        window.shareApp = async function() {
            const snap = await get(ref(db, 'admin/sharelink'));
            const link = snap.exists() ? snap.val() : window.location.href;
            if (navigator.share) {
                navigator.share({ title: 'Learnova', text: 'Check out this learning platform!', url: link });
            } else {
                navigator.clipboard.writeText(link);
                alert('Link copied to clipboard!');
            }
        };

        function initCountryList() {
            const listContainer = document.getElementById('countryListContainer');
            listContainer.innerHTML = top50Countries.map(c => `<div class="country-item" onclick="selectCountry('${c}')"><span>${c}</span><i data-lucide="check" class="w-4 h-4 text-[#7B4AE2] opacity-0 check-icon"></i></div>`).join('');
            lucide.createIcons();
        }
        window.openCountrySelector = function() { openModal('countryModal'); }
        window.selectCountry = function(country) {
            document.getElementById('regCountry').value = country;
            document.getElementById('regCountryDisplay').innerText = country;
            document.getElementById('regCountryDisplay').classList.remove('text-zinc-400');
            document.getElementById('regCountryDisplay').classList.add('text-white', 'font-bold');
            closeModal('countryModal');
        }

        function checkSession() {
            const m = localStorage.getItem('learnova_user_mobile');
            if(m) get(ref(db, 'users/'+m)).then(s => { if(s.exists()) loginSuccess(s.val()); else document.getElementById('authPage').classList.remove('hidden'); setTimeout(()=>document.getElementById('loadingOverlay').style.display='none', 800); });
            else { setTimeout(()=>document.getElementById('loadingOverlay').style.display='none', 800); document.getElementById('authPage').classList.remove('hidden'); }
        }
        window.toggleAuth = function(m) {
            document.getElementById('loginContainer').classList.toggle('hidden', m==='signup');
            document.getElementById('signupContainer').classList.toggle('hidden', m==='login');
        };
        document.getElementById('loginForm').addEventListener('submit', async e => {
            e.preventDefault();
            const s = await get(ref(db, 'users/'+document.getElementById('loginMobile').value));
            if(s.exists() && s.val().password === document.getElementById('loginPass').value) loginSuccess(s.val());
            else alert("Invalid");
        });
        document.getElementById('signupForm').addEventListener('submit', async e => {
            e.preventDefault();
            if(document.getElementById('regPass').value !== document.getElementById('regConfirmPass').value) return alert("Mismatch");
            const u = { userFullName: document.getElementById('regName').value, mobileNumber: document.getElementById('regMobile').value, country: document.getElementById('regCountry').value, age: document.getElementById('regAge').value, password: document.getElementById('regPass').value };
            if(!u.country) return alert("Please select a country");
            await set(ref(db, 'users/'+u.mobileNumber), u);
            loginSuccess(u);
        });
        function loginSuccess(u) {
            currentUser = u; localStorage.setItem('learnova_user_mobile', u.mobileNumber);
            document.getElementById('authPage').classList.add('hidden');
            document.getElementById('profileName').innerText = u.userFullName;
            document.getElementById('profileMobile').innerText = "+91 "+u.mobileNumber;
            renderCourses();
        }

        window.openModal = function(id) { document.getElementById(id).classList.add('active'); };
        window.openNameModal = function() { if(currentUser) { document.getElementById('newNameInput').value = currentUser.userFullName; } openModal('nameModal'); };
        window.closeModal = function(id) { document.getElementById(id).classList.remove('active'); };
        window.saveNewName = async function() {
            const newName = document.getElementById('newNameInput').value;
            if(!newName) return;
            if(currentUser) { await update(ref(db, 'users/' + currentUser.mobileNumber), { userFullName: newName }); currentUser.userFullName = newName; document.getElementById('profileName').innerText = newName; closeModal('nameModal'); }
        }
        window.performLogout = function() { localStorage.removeItem('learnova_user_mobile'); location.reload(); };
        window.toggleFaq = function(el) { el.parentElement.classList.toggle('open'); }

        async function renderCertificates() {
            const list = document.getElementById('certificatesList');
            if(!currentUser) return list.innerHTML = '<div class="text-muted-dynamic text-center py-10">Please login.</div>';
            const snap = await get(ref(db, `admin/userCourseEnrollment/${currentUser.mobileNumber}`));
            if(!snap.exists()) return list.innerHTML = '<div class="text-muted-dynamic text-center py-10">No certificates available.</div>';
            
            const enrollmentData = snap.val();
            let certsFound = false;
            let html = '';

            for (const [courseId, data] of Object.entries(enrollmentData)) {
                if(data.Certificate && data.Certificate.trim() !== "") {
                    const courseInfo = courses.find(c => c.id === courseId);
                    if(courseInfo) {
                        certsFound = true;
                        html += `
                        <div class="flex gap-4 p-4 surface-card rounded-2xl items-center border-l-4 border-l-[#7B4AE2] cursor-pointer" onclick="window.open('${data.Certificate}', '_blank')">
                            <div class="w-10 h-10 rounded-full bg-[#7B4AE2]/20 flex items-center justify-center text-[#7B4AE2]"><i data-lucide="award" class="w-5 h-5"></i></div>
                            <div class="flex-1"><h4 class="text-dynamic font-bold text-sm">${courseInfo.title}</h4><p class="text-[10px] text-green-500 font-bold">Completed</p></div>
                            <i data-lucide="download" class="w-5 h-5 text-zinc-500"></i>
                        </div>`;
                    }
                }
            }

            if(!certsFound) list.innerHTML = '<div class="text-muted-dynamic text-center py-10">Complete courses to earn certificates.</div>';
            else { list.innerHTML = html; lucide.createIcons(); }
        }

        function initSearch() {
            const input = document.getElementById('searchInput');
            const sug = document.getElementById('searchSuggestions');
            const body = document.body;
            input.addEventListener('focus', () => { body.classList.add('is-searching'); sug.style.display = 'block'; updateSuggestions(''); });
            input.addEventListener('input', (e) => updateSuggestions(e.target.value));
            input.addEventListener('keypress', (e) => { if(e.key==='Enter') performSearch(input.value); });
            document.addEventListener('click', (e) => { if(body.classList.contains('is-searching')) { const container = document.getElementById('searchContainer'); if(!container.contains(e.target)) { body.classList.remove('is-searching'); sug.style.display = 'none'; input.blur(); } } });
        }
        function updateSuggestions(val) {
            const list = document.getElementById('searchSuggestions');
            if(!val) {
                const rnd = courses.sort(() => 0.5 - Math.random()).slice(0, 3);
                list.innerHTML = `<p class="text-[10px] text-zinc-500 font-bold uppercase mb-2 px-2">Trending</p>` + rnd.map(c => `<div class="flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer" onclick="performSearch('${c.title}')"><i data-lucide="trending-up" class="w-4 h-4 text-[#7B4AE2]"></i><span class="text-xs font-bold text-zinc-300">${c.title}</span></div>`).join('');
            } else {
                const matched = courses.filter(c => c.title.toLowerCase().includes(val.toLowerCase())).slice(0, 4);
                list.innerHTML = matched.length ? matched.map(c => `<div class="flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer" onclick="openCourse('${c.link}')"><img src="${c.img}" class="w-8 h-8 rounded-md grayscale"><p class="text-xs font-bold text-dynamic">${c.title}</p></div>`).join('') : `<div class="p-2 text-xs text-muted-dynamic">No matches</div>`;
            }
            lucide.createIcons();
        }
        window.performSearch = function(q) {
            if(!q) return;
            showPage('search');
            document.getElementById('queryText').innerText = q;
            const res = courses.filter(c => c.title.toLowerCase().includes(q.toLowerCase()));
            const grid = document.getElementById('searchResultsGrid');
            grid.innerHTML = res.length ? res.map(c => `<div class="flex gap-4 p-4 surface-card rounded-2xl cursor-pointer" onclick="openCourse('${c.link}')"><img src="${c.img}" class="w-20 h-20 rounded-xl grayscale object-cover"><div class="flex-1"><h4 class="text-dynamic font-bold text-sm">${c.title}</h4><p class="text-[#7B4AE2] text-xs font-bold mt-1">₹${c.price}</p></div><i data-lucide="chevron-right" class="w-5 h-5 text-muted-dynamic"></i></div>`).join('') : `<div class="text-center py-20 text-muted-dynamic">No results.</div>`;
            lucide.createIcons();
        };

        const OR_KEY = "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";
        const OR_MODEL = "deepseek/deepseek-r1-0528:free";

        window.sendChat = async function() {
            const i = document.getElementById('chatInput');
            const txt = i.value.trim();
            if(!txt) return;

            const c = document.getElementById('chatHistory');
            c.innerHTML += `<div class="chat-bubble chat-user">${txt}</div>`;
            i.value = '';
            c.scrollTop = c.scrollHeight;

            const loadingId = 'loading-' + Date.now();
            c.innerHTML += `<div id="${loadingId}" class="chat-bubble chat-bot">...</div>`;
            c.scrollTop = c.scrollHeight;

            try {
                const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${OR_KEY}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        "model": OR_MODEL,
                        "messages": [
                            {"role": "system", "content": "You are BrainyBot, a helpful AI teaching assistant for Learnova. Keep answers concise. BrainyBot created by Himanshu Khandekar from India, Chhattisgarh, Bilaspur."},
                            {"role": "user", "content": txt}
                        ]
                    })
                });

                const data = await response.json();
                const aiText = data.choices?.[0]?.message?.content || "I'm having trouble connecting right now.";
                document.getElementById(loadingId).remove();
                c.innerHTML += `<div class="chat-bubble chat-bot">${aiText}</div>`;
                c.scrollTop = c.scrollHeight;
            } catch (error) {
                console.error(error);
                document.getElementById(loadingId).remove();
                c.innerHTML += `<div class="chat-bubble chat-bot">Connection error. Please try again.</div>`;
            }
        };
    </script>
</body>
</html>
